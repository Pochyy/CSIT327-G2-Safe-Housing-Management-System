    {% load custom_filters %}

    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Renter Dashboard - Safe Haven</title>
        {% load static %}
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link rel="stylesheet" href="{% static 'renterPage/renter.css' %}?v=3">
            
    </head>
    
    <body>
        <!-- Header Container -->
        <div class="header-container">
            <div class="header-content">
                <div class="logo-section">
                    <img src="{% static 'images/SH.png' %}" alt="Safe Haven Logo">
                    <h2>Safe <span>Haven</span></h2>
                </div>

                    
                    <div class="user-info" id="userDropdownBtn">
                        <div>{{ user.first_name }} {{ user.last_name }}</div>
                        <div class="user-avatar">{{ user.first_name|first }}{{ user.last_name|first }}</div>
                        <div class="user-dropdown" id="userDropdown">
                            <div class="user-dropdown-item">
                                <i class="fas fa-user-circle"></i> My Profile
                            </div>
                            <div class="user-dropdown-item">
                                <i class="fas fa-cog"></i> Settings
                            </div>
                            <div class="user-dropdown-divider"></div>
                            <div class="user-dropdown-item" id="logoutBtn">
                                <form action="{% url 'users:logout' %}" method="post" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" style="background: none; border: none; color: inherit; cursor: pointer; width: 100%; text-align: left;">
                            <i class="fas fa-sign-out-alt"></i> Logout
                            </button>
                            </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar">
            <div class="filter-container">
                <div class="input-group">
                    <label for="search">Search</label>
                    <input type="text" id="search" placeholder="Search properties...">
                </div>
                <div class="input-group">
                    <label for="location">Location</label>
                    <input type="text" id="location" placeholder="Enter city or area...">
                </div>
                <div class="input-group">
                    <label for="price-min">Min Price</label>
                    <input type="number" id="price-min" placeholder="₱0" value="0">
                </div>
                <div class="input-group">
                    <label for="price-max">Max Price</label>
                    <input type="number" id="price-max" placeholder="₱50,000" value="50000">
                </div>
                
                <!-- Filter Button -->
                <div class="input-group">
                    <label>&nbsp;</label>
                    <button class="filter-toggle-btn" id="filterToggleBtn">
                        <i class="fas fa-filter"></i>
                        Filters
                        <span class="filter-count" id="filterCount">0</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Filter Modal/Sidebar -->
        <div class="filter-modal" id="filterModal">
            <div class="filter-modal-content">
                <div class="filter-modal-header">
                    <h3><i class="fas fa-filter"></i> Filter Properties</h3>
                    <button class="close-filter-btn" id="closeFilterBtn" title="Close filter menu">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="filter-modal-body">
                    <!-- Basic Amenities -->
                    <div class="filter-section">
                        <h4><i class="fas fa-home"></i> Basic Amenities</h4>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="electricity">
                                <span class="check-icon">
                                    <i class="fas fa-bolt"></i> Electricity
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="water">
                                <span class="check-icon">
                                    <i class="fas fa-tint"></i> Water supply
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="internet">
                                <span class="check-icon">
                                    <i class="fas fa-wifi"></i> Internet / Wi-Fi
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="airconditioning">
                                <span class="check-icon">
                                    <i class="fas fa-wind"></i> Airconditioning
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="kitchen">
                                <span class="check-icon">
                                    <i class="fas fa-utensils"></i> Kitchen
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="shared_kitchen">
                                <span class="check-icon">
                                    <i class="fas fa-utensil-spoon"></i> Shared kitchen
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="private_bathroom">
                                <span class="check-icon">
                                    <i class="fas fa-bath"></i> Private bathroom
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="shared_bathroom">
                                <span class="check-icon">
                                    <i class="fas fa-restroom"></i> Shared bathroom
                                </span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Safety & Security -->
                    <div class="filter-section">
                        <h4><i class="fas fa-shield-alt"></i> Safety & Security</h4>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="secure_locks">
                                <span class="check-icon">
                                    <i class="fas fa-lock"></i> Secure locks
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="cctv">
                                <span class="check-icon">
                                    <i class="fas fa-video"></i> CCTV
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="gated_compound">
                                <span class="check-icon">
                                    <i class="fas fa-door-closed"></i> Gated compound
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="security_guard">
                                <span class="check-icon">
                                    <i class="fas fa-user-shield"></i> Security guard
                                </span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Property Features -->
                    <div class="filter-section">
                        <h4><i class="fas fa-tools"></i> Property Features</h4>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="parking">
                                <span class="check-icon">
                                    <i class="fas fa-parking"></i> Parking
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="furnished">
                                <span class="check-icon">
                                    <i class="fas fa-couch"></i> Furnished
                                </span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="amenities" value="pet_friendly">
                                <span class="check-icon">
                                    <i class="fas fa-paw"></i> Pet friendly
                                </span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="filter-modal-footer">
                    <button class="btn-secondary" id="clearFiltersBtn">
                        <i class="fas fa-eraser"></i> Clear All
                    </button>
                    <button class="btn-primary" id="applyFiltersBtn">
                        <i class="fas fa-check"></i> Apply Filters
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container">
            <div class="dashboard-header">
                <div>
                    <h1>Available Properties</h1>
                    <p class="text-muted"><span id="property-count">{{ properties.count }}</span> properties found</p>
                </div>
            </div>

            <!-- Property Grid -->
        <div class="property-grid" id="property-container">
            {% for property in properties %}
            <div class="property-card" data-price="{{ property.price }}" data-location="{{ property.location|lower }}">
                {% if property.image %}
                <div class="property-image">
                    <img src="{{ property.image.url }}" alt="{{ property.property_name }}">
                </div>
                {% else %}
                <div class="property-image placeholder">
                    <i class="fas fa-home"></i>
                    <span>No Image Available</span>
                </div>
                {% endif %}
                
                <div class="property-content">
                    <div class="property-header">
                        <div class="property-info">
                            <h3 class="property-title">{{ property.property_name }}</h3>
                            <p class="property-location">
                                <i class="fas fa-map-marker-alt"></i>
                                {{ property.location }}
                            </p>
                        </div>
                        <span class="property-price">₱{{ property.price|intcomma }}/month</span>
                    </div>
                    
                    <div class="property-features">
                        <span class="feature">
                            <i class="fas fa-bed"></i>
                            {{ property.beds }} bed{{ property.beds|pluralize }}
                        </span>
                        <span class="feature">
                            <i class="fas fa-bath"></i>
                            {{ property.bathrooms }} bath{{ property.bathrooms|pluralize }}
                        </span>
                        <span class="feature">
                            <i class="fas fa-vector-square"></i>
                            {{ property.area }} sq ft
                        </span>
                    </div>
                    
                    <p class="property-description">{{ property.property_description|truncatewords:20 }}</p>
                    
                    <div class="amenities-container">
                        <div class="amenities-section">
                            <h5>Amenities</h5>
                            <div class="property-amenities">
                                {% if property.electricity %}<span class="amenity-tag"><i class="fas fa-bolt"></i> Electricity</span>{% endif %}
                                {% if property.water %}<span class="amenity-tag"><i class="fas fa-tint"></i> Water</span>{% endif %}
                                {% if property.internet %}<span class="amenity-tag"><i class="fas fa-wifi"></i> Internet</span>{% endif %}
                                {% if property.airconditioning %}<span class="amenity-tag"><i class="fas fa-wind"></i> AC</span>{% endif %}
                                {% if property.kitchen %}<span class="amenity-tag"><i class="fas fa-utensils"></i> Kitchen</span>{% endif %}
                                {% if property.shared_kitchen %}<span class="amenity-tag"><i class="fas fa-utensil-spoon"></i> Shared Kitchen</span>{% endif %}
                                {% if property.private_bathroom %}<span class="amenity-tag"><i class="fas fa-bath"></i> Private Bathroom</span>{% endif %}
                                {% if property.shared_bathroom %}<span class="amenity-tag"><i class="fas fa-restroom"></i> Shared Bathroom</span>{% endif %}
                                {% if property.parking %}<span class="amenity-tag"><i class="fas fa-parking"></i> Parking</span>{% endif %}
                                {% if property.furnished %}<span class="amenity-tag"><i class="fas fa-couch"></i> Furnished</span>{% endif %}
                                {% if property.pet_friendly %}<span class="amenity-tag"><i class="fas fa-paw"></i> Pet Friendly</span>{% endif %}
                            </div>
                        </div>
                        
                        <div class="amenities-section">
                            <h5>Safety</h5>
                            <div class="property-safety">
                                {% if property.secure_locks %}<span class="safety-tag"><i class="fas fa-lock"></i> Secure Locks</span>{% endif %}
                                {% if property.cctv %}<span class="safety-tag"><i class="fas fa-video"></i> CCTV</span>{% endif %}
                                {% if property.gated_compound %}<span class="safety-tag"><i class="fas fa-gate"></i> Gated Compound</span>{% endif %}
                                {% if property.security_guard %}<span class="safety-tag"><i class="fas fa-user-shield"></i> Security Guard</span>{% endif %}
                            </div>
                        </div>
                    </div>
                    <button class="view-details-btn" data-property-id="{{ property.id }}">
                        <i class="fas fa-eye"></i> View Details
                    </button>
                </div>
            </div>
            {% empty %}
            <div class="no-properties">
                <i class="fas fa-home fa-3x"></i>
                <h3>No Properties Available</h3>
                <p>There are currently no approved properties in the system.</p>
            </div>
            {% endfor %}
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>© 2025 Safe Haven. All rights reserved.</p>
        </footer>

        <!-- Overlay for modal -->
        <div class="modal-overlay" id="modalOverlay"></div>
    
        <script>
            // Force price alignment after page loads
            document.addEventListener('DOMContentLoaded', function() {
                const prices = document.querySelectorAll('.property-price');
                prices.forEach(price => {
                    price.style.setProperty('display', 'inline-block', 'important');
                    price.style.setProperty('width', 'auto', 'important');
                    price.style.setProperty('max-width', 'none', 'important');
                });
            });
            </script>
            
            <script src="{% static 'renterPage/renter.js' %}"></script>
            </body>
            </html>
            

    </body>
    </html>